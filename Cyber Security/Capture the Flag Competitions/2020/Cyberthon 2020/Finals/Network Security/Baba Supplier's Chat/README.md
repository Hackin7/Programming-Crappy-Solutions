# Baba Supplier's Chat
180, NETWORK SECURITY, 13 SOLVES

## Description
ShoppingBaba uses a chat server to interact with their suppliers.

Their suppliers connects to this chat server by using a client python script. Upon connecting, the server usually will provide the supplier with a random username with password for login purposes.

However, suppliers now complain that the connection ends too quickly and they can no longer login!

Investigate the client script and connect to p7ju6oidw6ayykt9zeglwyxired60yct.ctf.sg:21011 to get to the bottom of this!

## Given
client.py

# Solution
Upon reading the client.py, the part that stands out the most to me is this
```
try:    
    #Standard login
    data = sock.recv(1024)
    print >>sys.stderr, 'received "%s"' % data
    print 'sending "%s" ' % "shake_baba"
    sock.sendall("shake_baba")
    data = sock.recv(1024)
    print >>sys.stderr, 'received "%s"' % data

    # Reply hash of the message send to login
    print 'sending hashed "%s" ' % str(data)
    sock.sendall(str(hash(data)))

    data = sock.recv(1024)
    print >>sys.stderr, 'received "%s"' % data

    # Get login credentials
    print 'sending hashed "%s" ' % str(data)
    sock.sendall("Hello!")

    data = sock.recv(1024)
    print >>sys.stderr, 'received "%s"' % data
```

The code above basically retrieves data from and sends data to the server 3 times. That's why the connection is so short.
What I did was to retrieve and send data many times (using a while loop), as shown in the code below

```
try:    
    #Standard login
    data = sock.recv(1024)
    print >>sys.stderr, 'received "%s"' % data
    print 'sending "%s" ' % "shake_baba"
    sock.sendall("shake_baba")
    data = sock.recv(1024)
    print >>sys.stderr, 'received "%s"' % data

    ### Basically change the code such that it runs many times ###########
    while True:
        # Reply hash of the message send to login
        print 'sending hashed "%s" ' % str(data)
        sock.sendall(str(hash(data)))

        data = sock.recv(1024)
        print >>sys.stderr, 'received "%s"' % data
    ######################################################################
```

By the way, the code has to run on python2, which is annoying, but at least I have it installed I guess, so it's not so bad.

And here's the output:
```
$ python2 ./solve.py p7ju6oidw6ayykt9zeglwyxired60yct.ctf.sg 21011
connecting to p7ju6oidw6ayykt9zeglwyxired60yct.ctf.sg port 21011
received "Welcome to ShoppingBaba Supplier's Chat Server!"
sending "shake_baba"
received "courage"
sending hashed "courage"
received "related"
sending hashed "related"
received "top"
sending hashed "top"
received "on"
sending hashed "on"
received "difficult"
sending hashed "difficult"
received "begun"
sending hashed "begun"
received "master"
sending hashed "master"
received "count"
sending hashed "count"
received "wrote"
sending hashed "wrote"
received "shown"
sending hashed "shown"
received "pay"
sending hashed "pay"
received "nobody"
sending hashed "nobody"
received "salmon"
sending hashed "salmon"
received "create"
sending hashed "create"
received "more"
sending hashed "more"
received "actually"
sending hashed "actually"
received "brief"
sending hashed "brief"
received "continent"
sending hashed "continent"
received "door"
sending hashed "door"
received "fully"
sending hashed "fully"
received "want"
sending hashed "want"
received "believed"
sending hashed "believed"
received "angry"
sending hashed "angry"
received "instant"
sending hashed "instant"
received "tears"
sending hashed "tears"
received "ants"
sending hashed "ants"
received "this"
sending hashed "this"
received "recently"
sending hashed "recently"
received "indicate"
sending hashed "indicate"
received "model"
sending hashed "model"
received "of"
sending hashed "of"
received "animal"
sending hashed "animal"
received "tank"
sending hashed "tank"
received "consist"
sending hashed "consist"
received "wealth"
sending hashed "wealth"
received "wing"
sending hashed "wing"
received "ten"
sending hashed "ten"
received "caught"
sending hashed "caught"
received "pack"
sending hashed "pack"
received "pipe"
sending hashed "pipe"
received "dozen"
sending hashed "dozen"
received "phrase"
sending hashed "phrase"
received "doing"
sending hashed "doing"
received "lucky"
sending hashed "lucky"
received "eight"
sending hashed "eight"
received "birthday"
sending hashed "birthday"
received "grow"
sending hashed "grow"
received "field"
sending hashed "field"
received "pair"
sending hashed "pair"
received "smaller"
sending hashed "smaller"
received "found"
sending hashed "found"
received "mouse"
sending hashed "mouse"
received "necessary"
sending hashed "necessary"
received "way"
sending hashed "way"
received "support"
sending hashed "support"
received "coffee"
sending hashed "coffee"
received "fine"
sending hashed "fine"
received "ranch"
sending hashed "ranch"
received "reason"
sending hashed "reason"
received "wherever"
sending hashed "wherever"
received "traffic"
sending hashed "traffic"
received "egg"
sending hashed "egg"
received "variety"
sending hashed "variety"
received "form"
sending hashed "form"
received "sense"
sending hashed "sense"
received "instance"
sending hashed "instance"
received "mirror"
sending hashed "mirror"
received "road"
sending hashed "road"
received "hospital"
sending hashed "hospital"
received "charge"
sending hashed "charge"
received "liquid"
sending hashed "liquid"
received "face"
sending hashed "face"
received "class"
sending hashed "class"
received "sea"
sending hashed "sea"
received "connected"
sending hashed "connected"
received "active"
sending hashed "active"
received "finest"
sending hashed "finest"
received "discuss"
sending hashed "discuss"
received "larger"
sending hashed "larger"
received "obtain"
sending hashed "obtain"
received "chief"
sending hashed "chief"
received "slope"
sending hashed "slope"
received "action"
sending hashed "action"
received "string"
sending hashed "string"
received "son"
sending hashed "son"
received "dawn"
sending hashed "dawn"
received "ordinary"
sending hashed "ordinary"
received "comfortable"
sending hashed "comfortable"
received "both"
sending hashed "both"
received "pet"
sending hashed "pet"
received "represent"
sending hashed "represent"
received "difference"
sending hashed "difference"
received "birthday"
sending hashed "birthday"
received "review"
sending hashed "review"
received "corner"
sending hashed "corner"
received "effect"
sending hashed "effect"
received "struggle"
sending hashed "struggle"
received "except"
sending hashed "except"
received "toy"
sending hashed "toy"
received "ready"
sending hashed "ready"
received "week"
sending hashed "week"
received "compass"
sending hashed "compass"
received "horse"
sending hashed "horse"
received "carry"
sending hashed "carry"
received "new"
sending hashed "new"
received "am"
sending hashed "am"
received "sort"
sending hashed "sort"
received "system"
sending hashed "system"
received "page"
sending hashed "page"
received "factory"
sending hashed "factory"
received "bit"
sending hashed "bit"
received "egg"
sending hashed "egg"
received "stick"
sending hashed "stick"
received "event"
sending hashed "event"
received "today"
sending hashed "today"
received "drove"
sending hashed "drove"
received "service"
sending hashed "service"
received "sing"
sending hashed "sing"
received "poet"
sending hashed "poet"
received "although"
sending hashed "although"
received "wave"
sending hashed "wave"
received "combine"
sending hashed "combine"
received "quickly"
sending hashed "quickly"
received "character"
sending hashed "character"
received "younger"
sending hashed "younger"
received "party"
sending hashed "party"
received "such"
sending hashed "such"
received "increase"
sending hashed "increase"
received "fell"
sending hashed "fell"
received "soldier"
sending hashed "soldier"
received "independent"
sending hashed "independent"
received "magnet"
sending hashed "magnet"
received "ruler"
sending hashed "ruler"
received "real"
sending hashed "real"
received "island"
sending hashed "island"
received "mother"
sending hashed "mother"
received "summer"
sending hashed "summer"
received "telephone"
sending hashed "telephone"
received "repeat"
sending hashed "repeat"
received "due"
sending hashed "due"
received "dozen"
sending hashed "dozen"
received "gas"
sending hashed "gas"
received "bite"
sending hashed "bite"
received "spread"
sending hashed "spread"
received "depend"
sending hashed "depend"
received "gasoline"
sending hashed "gasoline"
received "central"
sending hashed "central"
received "for"
sending hashed "for"
received "luck"
sending hashed "luck"
received "Cyberthon{chat_pwned}"
sending hashed "Cyberthon{chat_pwned}"
received ""
sending hashed ""
received ""
sending hashed ""
received ""
sending hashed ""
socket.error - Broken pipe addr:  ('p7ju6oidw6ayykt9zeglwyxired60yct.ctf.sg', 21011)
```

# Flag
`Cyberthon{chat_pwned}`